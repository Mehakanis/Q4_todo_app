# cert-manager installation for automatic TLS certificate provisioning
# Uses Let's Encrypt to issue free SSL certificates

apiVersion: v1
kind: Namespace
metadata:
  name: cert-manager

---
# Install cert-manager using Helm (this is a placeholder YAML)
# Actual installation command:
# helm repo add jetstack https://charts.jetstack.io
# helm repo update
# helm install cert-manager jetstack/cert-manager \
#   --namespace cert-manager \
#   --version v1.13.0 \
#   --set installCRDs=true

# ClusterIssuer for Let's Encrypt (production)
---
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
  namespace: cert-manager
spec:
  acme:
    # Let's Encrypt production server
    server: https://acme-v02.api.letsencrypt.org/directory

    # Email for expiration notifications
    email: admin@example.com  # Replace with your email

    # Secret to store ACME account private key
    privateKeySecretRef:
      name: letsencrypt-prod-account-key

    # HTTP-01 challenge solver
    solvers:
      - http01:
          ingress:
            class: nginx

---
# ClusterIssuer for Let's Encrypt (staging - for testing)
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-staging
  namespace: cert-manager
spec:
  acme:
    # Let's Encrypt staging server (for testing)
    server: https://acme-staging-v02.api.letsencrypt.org/directory

    email: admin@example.com  # Replace with your email

    privateKeySecretRef:
      name: letsencrypt-staging-account-key

    solvers:
      - http01:
          ingress:
            class: nginx
